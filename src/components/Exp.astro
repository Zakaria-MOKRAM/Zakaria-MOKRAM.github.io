---
const experiences = [
    {
        year: '2024',
        positions: [
            {
                title: 'Junior - Full Stack Developer',
                company: 'AGIWISE - Rabat, Morocco',
                description: [
                    'Developed a CMMS (Computerized Maintenance Management System) application to efficiently manage equipment maintenance.',
                    '→ Tools : Spring Boot, Spring Security, JWT | Thymeleaf | SQL | Docker Container'
                ]
            },
            {
                title: 'Junior - Full Stack Intern Developer',
                company: 'JWAYS Services - Agadir, Morocco',
                description: [
                    'Contributed to the development of a POS application for restaurants, streamlining order management, payments, and inventory.',
                    '→ Tools : React | Spring Boot, Spring Security, JWT | SQL '
                ]
            }
        ]
    },
    {
        year: '2023',
        positions: [
        {
                title: 'Junior - Full Stack Intern Developer',
                company: 'DACHI COM - Agadir, Morocco',
                description: [
                    'The Employee Management System (EMS) automates HR tasks like data management, leave tracking, and performance monitoring, with a scalable architecture and flexible design for future enhancements.',
                    '→ Tools : Spring Boot, Hibernate | Angular | SQL '
                ]
            }
        ]
    },
    {
        year: '2022',
        positions: [
            {
                title: 'Junior - Full Stack Intern Developer',
                company: 'INTICSOLUTIONS - Agadir, Morocco',
                description: [
                    'Developed a web application for managing a surf camp.',
                    '→ Tools : React, JavaScript | Laravel Framework (PHP) | MySQL '
                ]
            },
            {
                title: 'Web Application "Hermies"',
                company: 'End-of-Year Project : EMSI - Honoris United Universities ',
                description: [
                    'Designed and developed a web application for the "Hermies" Hotel to manage reservations, clients, rooms, billing, etc.',
                    '→ Tools : Django Framework (Python) | Bootstrap | MySQL '
                ]
            }
        ]
    }
];
---

<div class="experience">
    {experiences.map((exp, yearIndex) => (
        <div class="year-block" data-key={yearIndex}>
            <div class="year">
                <span>{exp.year}</span>
            </div>
            <div class="positions">
                {exp.positions.map((position, posIndex) => (
                    <div class="position" data-key={posIndex}>
                        <h4>{position.title}</h4>
                        <p>{position.company}</p>
                        <a href="javascript:void(0);" onclick={`toggleDescription('desc-${yearIndex}-${posIndex}')`} class="read-more-link">
                            Read More
                        </a>
                        <div id={`desc-${yearIndex}-${posIndex}`} class="description" style="display: none;">
                            {
                                Array.isArray(position.description)
                                    ? position.description.map((line, idx) => <p data-key={idx}>{line}</p>)
                                    : <p>{position.description}</p>
                            }
                        </div>
                    </div>
                ))}
            </div>
        </div>
    ))}
</div>

<script is:inline>
    function toggleDescription(id) {
        const description = document.getElementById(id);
        if (description.style.display === 'none' || !description.style.display) {
            description.style.display = 'block';
        } else {
            description.style.display = 'none';
        }
    }
</script>

<style>
    .read-more-link {
        display: inline-block;
        margin-top: 0.5rem;
        color: var(--accent-regular);
        font-size: var(--text-sm);
        text-decoration: underline;
        cursor: pointer;
        background: none;
        border: none;
        padding: 0;
    }

    .read-more-link:hover {
        color: var(--accent-light);
    }
    .description {
        margin-top: 0.5rem;
        color: var(--gray-200);
    }
    .experience {
        width: 50%;
        align-items: right;
        flex-direction: column;
        display: grid;
        grid-template-columns: repeat(auto-fit);
        gap: 1.5rem;
        padding: 1rem;
        margin: auto;
    }

    .year-block {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 2rem;
        align-items: start;
    }

    .year {
        color: var(--accent-regular);
        font-family: var(--font-brand);
        font-size: var(--text-xl);
        font-weight: 600;
        padding-top: 0.5rem;
        min-width: 100px;
    }

    .positions {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        flex: 1;
    }

    .position {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        padding: 1rem;
        background: var(--gradient-subtle);
        border: 1px solid var(--gray-800);
        border-radius: 0.75rem;
        box-shadow: var(--shadow-sm);
    }

    .position h4 {
        font-size: var(--text-lg);
        font-weight: 600;
        color: var(--gray-100);
        margin: 0;
    }

    .position p {
        font-size: var(--text-md);
        color: var(--gray-300);
        margin: 0;
    }

    @media (max-width: 50em) {
        .year-block {
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .year {
            padding-top: 0;
        }

        .experience {
        width: 70%;
        }
    }
</style>